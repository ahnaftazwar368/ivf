import requests
from bs4 import BeautifulSoup
from urllib.parse import urljoin


def find_sqli_vulnerability(url, html):
    payloads = ["' OR '1'='1", "' OR '1'='2", "' OR 'a'='a"]
    soup = BeautifulSoup(html, "html.parser")
    forms = soup.find_all("form")

    for form in forms:
        action = form.get("action")
        method = form.get("method", "get").lower()
        inputs = form.find_all("input")

        for payload in payloads:
            print(f"Checking payload: {payload}")

            data = {}
            for input_tag in inputs:
                input_name = input_tag.get("name")
                input_type = input_tag.get("type", "text")
                input_value = input_tag.get("value", "")

                if input_type == "text":
                    data[input_name] = payload  # Use the payload here
                else:
                    data[input_name] = input_value

            target_url = urljoin(url, action)

            if method == "post":
                response = requests.post(target_url, data=data)
            else:
                response = requests.get(target_url, params=data)

            if (
                "SQL syntax" in response.text
                or "You have an error in your SQL syntax" in response.text
            ):
                print(f"Potential SQLi vulnerability found in form at {target_url}")
                return True
    return False

